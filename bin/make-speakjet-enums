#!/usr/bin/perl -W

opendir BANK7, "Source/Banks/Bank07" or die;

`mkdir -p Source/Generated/Common/`;

open COMMON, '>', 'Source/Generated/Common/SpeakJetIDs.s' or die;

print COMMON <<END;
;;; Source/Generated/Common/SpeakJetIDs.s
;;; generated from all Speech includes files
;;;
;;; These IDs are used to command various utterances
;;; to occur from the speech engine in Bank 7

END

$n = 1; # because $00 means "no speech"

while (my $dirent = readdir BANK7) {
  next unless $dirent =~ /(.*)Speech.txt/;

  open INFILE, '<', "Source/Banks/Bank07/$dirent";
  while (my $line = <INFILE>) {
    next unless $line =~ /^\s*([A-Za-z0-9_]+):/;

    printf COMMON "\n\tSpeech_%s := \$%02x", $1, $n++;
  };
};

print COMMON "\n\n;;; End of SpeakJet enums\n";

close COMMON;
closedir BANK7;
